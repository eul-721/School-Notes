# Web Side Architecture
---
## Character Sets/Encoding
- **character set**: a list of characters and character mappings
    - `ASCII` is universal: 95 characters, English only, but fits in 7 bits
- **character encoding**: how to convert characters numbers into bits
    - before Unicode, this was easy. One byte per character
    - however, with Unicode, there are more choices.
    - Can use `UTF-8` for everything
        - encodes Unicode efficiently
        - ASCII characters still one byte
- always explicitly declare encoding
    - `<meta charset=“utf-8” />`
- never guess character encoding
---
## Redirects

- we saw status codes `301`, `302`, `303`, `401`
- can be produced several ways
    - be web server: Apache’s `mod_alias`
        - Good for static content, whole sites, directories
    - in your code: you can return response with 301 status. Good for specific cases that need logic/DB info to detect.
- general principle: URLs should never become invalid
    - when planning, taking some time to come up with a good URL schema
---
## HTTP Caching

- browsers (and proxy servers) can both cache content to save time/network later
- when a request is made through a cache,
    1. cached copy is “fresh"
        - original was sent with an Expires header and expiring time hasn’t passed.
        - no need to check with server use cached copy.
    2. Have a cached copy, but expired.
        - request with if-modified-since header
        - unchanged: server responds `304 Not Modified` (no message body)
    3. changed: `200` and contents. Cache new contents
- for *static* content, server will have config for expiry times.
  - *e.g. `nginx` **expires** directive*
- for *dynamic* content,
  - **not cached by default**
  - programmer can set expires headers where possible
  - generate 304 responses
  - *frameworks* often provide support for caching.
  - can be combined with a reverse proxy for huge speedup
- the `Etag` header identifies specific contents
  - should change if and only if the contents change
  - generated by server for static contents
  - allows caching multiple copies with `If-none-match` header
- general tips:
  - for dynamic sites, remember that CSS+JS+images are static & infrequently change.
  - Use URLs consistently, minimize `POST`
  - set reasonable expires headers
---
## Content Negotiation

- different `HTTP` clients have different capabilities
- HTTP provides a way to automatically adapt content negotiation

### Media Type
  ```
  Accept text/html, text/plain;q=0.5, */*; q=0.1
  ```
  - indicates media types the browser can handle/prefers
  - `q=` indicates quality 0.0-1.0
  - `*/*` is *anything else*


### Language
  ```
  Accept-language: en, fr;q=0.5
  ```
  - what natural languages can the user read?
  - set by user config, so not always reliable.
  - if you use this, must allow the user to set a preference to
